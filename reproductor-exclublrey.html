<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ex Club Rey - En Vivo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .live-badge {
            display: inline-block;
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
            animation: pulse 2s infinite;
            box-shadow: 0 4px 8px rgba(231,76,60,0.3);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .player-container {
            background: rgba(0,0,0,0.8);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
        }

        .player-wrapper {
            position: relative;
            width: 100%;
            height: 0;
            padding-bottom: 56.25%; /* 16:9 aspect ratio */
            border-radius: 10px;
            overflow: hidden;
            background: #000;
        }

        .player-iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 10px;
        }

        .loading-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            border-radius: 10px;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top: 4px solid #fff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .info-section {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            backdrop-filter: blur(10px);
        }

        .info-section h2 {
            font-size: 1.5rem;
            margin-bottom: 15px;
            color: #fff;
        }

        .info-section p {
            line-height: 1.6;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 20px;
        }

        .btn {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: bold;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231,76,60,0.4);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #3498db, #2980b9);
        }

        .btn-secondary:hover {
            box-shadow: 0 5px 15px rgba(52,152,219,0.4);
        }

        .btn-danger {
            background: linear-gradient(45deg, #f39c12, #e67e22);
        }

        .btn-danger:hover {
            box-shadow: 0 5px 15px rgba(243,156,18,0.4);
        }

        .fullscreen-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 5px;
            cursor: pointer;
            z-index: 20;
            font-size: 0.9rem;
        }

        .fullscreen-btn:hover {
            background: rgba(0,0,0,0.9);
        }

        .error-message {
            background: rgba(231,76,60,0.2);
            border: 1px solid #e74c3c;
            color: #fadbd8;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .success-message {
            background: rgba(46,204,113,0.2);
            border: 1px solid #2ecc71;
            color: #d5f4e6;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .warning-message {
            background: rgba(243,156,18,0.2);
            border: 1px solid #f39c12;
            color: #fef9e7;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .controls {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 300px;
            }
        }

        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .player-container {
                padding: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Ex Club Rey</h1>
            <p>Disfruta del contenido m√°s exclusivo en vivo</p>
            <div class="live-badge">EN VIVO</div>
        </div>

        <div class="player-container">
            <div class="player-wrapper">
                <div class="loading-overlay" id="loadingOverlay">
                    <div class="loading-spinner"></div>
                </div>
                <iframe 
                    allow='encrypted-media' 
                    width='640' 
                    height='360' 
                    scrolling='no' 
                    frameborder='0' 
                    allowfullscreen 
                    src='https://topembed.pw/channel/exclublrey'
                    class="player-iframe" 
                    id="playerIframe"
                    onload="hideLoading()"
                    onerror="showError()">
                </iframe>
                <button class="fullscreen-btn" onclick="toggleFullscreen()">
                    ‚õ∂ Pantalla Completa
                </button>
            </div>
        </div>

        <div class="info-section">
            <h2>üì∫ Ex Club Rey</h2>
            <p>
                Ex Club Rey ofrece contenido exclusivo y entretenimiento de alta calidad. 
                Disfruta de la mejor programaci√≥n en vivo con la m√°xima calidad de transmisi√≥n. 
                No te pierdas ni un momento de la acci√≥n.
            </p>
            <div style="background: rgba(243,156,18,0.1); border: 1px solid #f39c12; border-radius: 8px; padding: 15px; margin-top: 15px;">
                <h3 style="color: #f39c12; margin-bottom: 10px;">‚ÑπÔ∏è Informaci√≥n Importante:</h3>
                <ul style="list-style: none; padding: 0; margin: 0;">
                    <li style="margin-bottom: 8px;">‚Ä¢ Los canales "ex" estar√°n en l√≠nea al inicio del evento</li>
                    <li style="margin-bottom: 8px;">‚Ä¢ Calidad SD 600kbps</li>
                    <li style="margin-bottom: 8px;">‚Ä¢ Evita canales TSN si hay m√°s de uno por evento</li>
                    <li style="margin-bottom: 8px;">‚Ä¢ Los embeds solo funcionan dentro de iframes</li>
                </ul>
            </div>
        </div>

        <div class="controls">
            <button class="btn" onclick="refreshPlayer()">
                üîÑ Recargar Reproductor
            </button>
            <a href="index.html" class="btn btn-secondary">
                üè† Volver al Inicio
            </a>
            <button class="btn btn-danger" onclick="openInNewTab()">
                üîó Abrir en Nueva Pesta√±a
            </button>
            <button class="btn" onclick="tryAlternativeMethod()" style="background: linear-gradient(45deg, #9b59b6, #8e44ad);">
                üîß M√©todo Alternativo
            </button>
        </div>

        <div id="messageContainer"></div>
    </div>

    <script>
        // Variables globales
        let isFullscreen = false;
        let playerLoaded = false;

        // M√©todo alternativo para cargar el reproductor
        function tryAlternativeMethod() {
            const iframe = document.getElementById('playerIframe');
            const loadingOverlay = document.getElementById('loadingOverlay');
            
            // Mostrar loading
            loadingOverlay.style.display = 'flex';
            loadingOverlay.innerHTML = '<div class="loading-spinner"></div>';
            
            // Intentar con diferentes m√©todos
            const methods = [
                'https://topembed.pw/channel/exclublrey',
                'https://topembed.pw/channel/exclublrey?ref=direct',
                'https://topembed.pw/channel/exclublrey?embed=true',
                'https://topembed.pw/channel/exclublrey?iframe=true'
            ];
            
            let currentMethod = 0;
            
            function tryNextMethod() {
                if (currentMethod < methods.length) {
                    iframe.src = methods[currentMethod] + '&t=' + Date.now();
                    currentMethod++;
                    setTimeout(tryNextMethod, 3000);
                } else {
                    showMessage('‚ùå Todos los m√©todos fallaron. Intenta abrir en nueva pesta√±a.', 'error');
                    loadingOverlay.style.display = 'none';
                }
            }
            
            tryNextMethod();
            showMessage('üîß Probando m√©todo alternativo...', 'warning');
        }

        // Ocultar loading cuando el iframe se carga
        function hideLoading() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            const messageContainer = document.getElementById('messageContainer');
            
            if (loadingOverlay) {
                loadingOverlay.style.display = 'none';
            }
            
            playerLoaded = true;
            showMessage('‚úÖ Reproductor cargado correctamente', 'success');
        }

        // Mostrar error si el iframe falla
        function showError() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (loadingOverlay) {
                loadingOverlay.innerHTML = `
                    <div style="text-align: center; color: white;">
                        <div style="font-size: 3rem; margin-bottom: 10px;">‚ö†Ô∏è</div>
                        <div>Error al cargar el reproductor</div>
                        <div style="font-size: 0.9rem; margin: 10px 0; opacity: 0.8;">
                            Error de referente detectado
                        </div>
                        <button class="btn" onclick="tryAlternativeMethod()" style="margin: 10px;">
                            üîß M√©todo Alternativo
                        </button>
                        <button class="btn" onclick="openInNewTab()" style="margin: 10px;">
                            üîó Nueva Pesta√±a
                        </button>
                    </div>
                `;
            }
            showMessage('‚ùå Error de referente. El sitio bloquea el acceso directo.', 'error');
        }

        // Funci√≥n para mostrar mensajes
        function showMessage(message, type) {
            const messageContainer = document.getElementById('messageContainer');
            const messageDiv = document.createElement('div');
            messageDiv.className = type === 'error' ? 'error-message' : 
                                  type === 'warning' ? 'warning-message' : 'success-message';
            messageDiv.textContent = message;
            
            messageContainer.innerHTML = '';
            messageContainer.appendChild(messageDiv);
            
            // Auto-remover mensaje despu√©s de 5 segundos
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.remove();
                }
            }, 5000);
        }

        // Recargar el reproductor
        function refreshPlayer() {
            const iframe = document.getElementById('playerIframe');
            const loadingOverlay = document.getElementById('loadingOverlay');
            
            // Mostrar loading
            loadingOverlay.style.display = 'flex';
            loadingOverlay.innerHTML = '<div class="loading-spinner"></div>';
            
            // Recargar iframe con timestamp
            const currentSrc = iframe.src.split('?')[0]; // Remover par√°metros existentes
            iframe.src = currentSrc + '?t=' + Date.now();
            
            showMessage('üîÑ Recargando reproductor...', 'success');
        }

        // Abrir en nueva pesta√±a con m√©todo especial
        function openInNewTab() {
            // Abrir la p√°gina dedicada sin restricciones de referente
            window.open('exclublrey-directo.html', '_blank');
            showMessage('üîó Abriendo Ex Club Rey en nueva pesta√±a...', 'success');
        }

        // Funci√≥n para pantalla completa
        function toggleFullscreen() {
            const playerWrapper = document.querySelector('.player-wrapper');
            
            if (!isFullscreen) {
                if (playerWrapper.requestFullscreen) {
                    playerWrapper.requestFullscreen();
                } else if (playerWrapper.webkitRequestFullscreen) {
                    playerWrapper.webkitRequestFullscreen();
                } else if (playerWrapper.msRequestFullscreen) {
                    playerWrapper.msRequestFullscreen();
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
            }
        }

        // Detectar cambios en pantalla completa
        document.addEventListener('fullscreenchange', updateFullscreenState);
        document.addEventListener('webkitfullscreenchange', updateFullscreenState);
        document.addEventListener('msfullscreenchange', updateFullscreenState);

        function updateFullscreenState() {
            isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement);
            const fullscreenBtn = document.querySelector('.fullscreen-btn');
            
            if (fullscreenBtn) {
                fullscreenBtn.textContent = isFullscreen ? '‚õ∂ Salir Pantalla Completa' : '‚õ∂ Pantalla Completa';
            }
        }

        // Detectar si el iframe est√° cargado despu√©s de un tiempo
        setTimeout(() => {
            if (!playerLoaded) {
                const iframe = document.getElementById('playerIframe');
                if (iframe && iframe.contentWindow) {
                    try {
                        // Intentar acceder al contenido del iframe
                        iframe.contentWindow.document;
                        hideLoading();
                    } catch (e) {
                        // Si hay error de CORS, asumir que se carg√≥ correctamente
                        hideLoading();
                    }
                }
            }
        }, 10000);

        // Navegaci√≥n por teclado
        document.addEventListener('keydown', function(e) {
            switch(e.key) {
                case 'f':
                case 'F':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        toggleFullscreen();
                    }
                    break;
                case 'r':
                case 'R':
                    if (e.ctrlKey || e.metaKey) {
                        e.preventDefault();
                        refreshPlayer();
                    }
                    break;
                case 'Escape':
                    if (isFullscreen) {
                        toggleFullscreen();
                    }
                    break;
            }
        });

        // Mostrar mensaje de bienvenida
        window.addEventListener('load', function() {
            setTimeout(() => {
                showMessage('üé¨ ¬°Disfruta de Ex Club Rey en vivo!', 'success');
            }, 1000);
        });

        // Detectar problemas de conexi√≥n
        window.addEventListener('online', function() {
            showMessage('‚úÖ Conexi√≥n restaurada', 'success');
        });

        window.addEventListener('offline', function() {
            showMessage('‚ùå Sin conexi√≥n a internet', 'error');
        });

        // Detectar errores de referente autom√°ticamente
        let errorCount = 0;
        const originalError = window.onerror;
        window.onerror = function(msg, url, line, col, error) {
            if (msg.includes('referrer') || msg.includes('Referrer') || msg.includes('null referrer')) {
                errorCount++;
                if (errorCount <= 2) {
                    setTimeout(() => {
                        showMessage('üîß Error de referente detectado, intentando m√©todo alternativo...', 'warning');
                        tryAlternativeMethod();
                    }, 2000);
                } else {
                    showMessage('‚ùå Error persistente. Usa "Abrir en Nueva Pesta√±a"', 'error');
                }
            }
            if (originalError) {
                return originalError(msg, url, line, col, error);
            }
        };
    </script>
</body>
</html>
